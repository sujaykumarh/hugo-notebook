{{- if not (.Page.Scratch.Get "katex") -}}
<!-- Include katext only first time -->
{{/*  <link rel="stylesheet" href="{{ "assets/katex/katex.min.css" | relURL }}" />  */}}
{{/*  <script defer src="{{ "assets/katex/katex.min.js" | relURL }}"></script>  */}}
{{/*  <script defer src="{{ "assets/katex/auto-render.min.js" | relURL }}" onload="renderMathInElement(document.body);"></script>  */}}

{{/*  from CDN  */}}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.x/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.x/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.x/dist/contrib/auto-render.min.js" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

{{- .Page.Scratch.Set "katex" true -}}
{{- end -}}

<span {{- with .Get "class" }} class="{{ . }}"{{ end }}>
  {{ cond (in .Params "display") "\\[" "\\(" -}}
  {{- trim .Inner "\n" -}}
  {{- cond (in .Params "display") "\\]" "\\)" }}
</span>
